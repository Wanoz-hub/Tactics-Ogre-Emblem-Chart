<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walkthrough</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
            color: #E5E7EB;
        }
        .font-medieval {
            font-family: 'MedievalSharp', cursive;
        }
        .content-container {
            background-color: rgba(31, 41, 55, 0.8);
            border-radius: 0.75rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid #4B5563;
            backdrop-filter: blur(4px);
        }
        thead th {
            font-family: 'MedievalSharp', cursive;
            background-color: #374151;
            color: #FBBF24;
            letter-spacing: 0.05em;
        }
        tbody tr:nth-child(even) {
            background-color: rgba(55, 65, 81, 0.5);
        }
        .nav-link {
            background-color: rgba(55, 65, 81, 0.8);
            color: #FBBF24;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            text-decoration: none;
            font-weight: 500;
            border: 1px solid #4B5563;
            transition: all 0.2s;
        }
        .nav-link:hover {
            background-color: #FBBF24;
            color: #111827;
        }
        .nav-link.disabled {
            opacity: 0.5;
            pointer-events: none;
        }
        select#battle-index {
            background-color: #374151;
            border-color: #4B5563;
            color: #FBBF24;
            -moz-appearance: none;
            -webkit-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23FBBF24%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right .7em top 50%;
            background-size: .65em auto;
            padding-right: 2.5em;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="fixed top-0 left-0 right-0 p-4 md:p-6 z-10 flex justify-between items-center">
        <a href="index.html" class="nav-link">&larr; Back to Main Hub</a>
        <div class="relative">
            <select id="battle-index" class="nav-link font-medieval text-lg">
                <!-- Options will be populated by JS -->
            </select>
        </div>
    </div>

    <div id="walkthrough-content" class="max-w-4xl mx-auto pt-24">
        <!-- Battle content will be rendered here by JavaScript -->
    </div>

    <script>
    // --- BATTLE DATA ---
    const battles = [
        // Battle 1
        { id: 'wk01', chapter: 'Chapter 1', name: 'Lutra Islands', difficulty: '1/10', mapSize: '13x11', winCondition: 'Defeat the leader (Bandit)', deployment: { player: '1 (Alphonse)', guest: '4', enemy: '4' }, enemies: [ { unit: 'Bandit [M] (Leader)', level: 3, hp: 151, spoils: 'Francisca', isLeader: true }, { unit: 'Soldier [M]', level: 1, hp: 130, spoils: 'Leather Hat' }, { unit: 'Soldier [F]', level: 1, hp: 130, spoils: 'Healing Leaf' }, { unit: 'Soldier [M]', level: 1, hp: 130, spoils: 'Cup of Life' } ], guests: [ { name: 'Rictor [M]', level: 3, hp: 173 }, { name: 'Justin [M]', level: 2, hp: 140 }, { name: 'Orson [M]', level: 2, hp: 116 }, { name: 'Lara [F]', level: 2, hp: 139 } ], strategy: [ "This battle serves as an introduction to the game's mechanics and is straightforward. The guest units are powerful and will handle most of the combat. Rictor will act as a healer, ensuring the party's survival.", "<strong>Protect Your Flank:</strong> Enemies will attempt to attack from the back for a tactical advantage. Position your units to prevent this, and try to do the same to them to increase damage and reduce the chance of counterattacks.", "<strong>Target the Leader for EXP:</strong> The enemy leader is a higher level than the other units. Attacking him will yield significantly more experience points. Have Alphonse focus his attacks on the leader when possible to maximize EXP gain. A killing blow on a higher-level enemy provides a substantial EXP bonus.", "<strong>Collect Item Bags:</strong> Defeated enemies may drop item bags containing useful curative items or equipment. Move a unit onto the tile with the bag to collect it. Any bags left on the battlefield at the end of the fight are automatically collected as war trophies." ], aftermath: "After the battle, a cutscene will play, and Ivanna will join your party." },
        // Battle 2
        { id: 'wk02', chapter: 'Chapter 1', name: 'Scabellum', difficulty: '2/10', mapSize: '18x16', winCondition: 'Defeat the leader (Wizard)', deployment: { player: '2 (Alphonse & Ivanna)', guest: '2', enemy: '4' }, enemies: [ { unit: 'Wizard [L] (Leader)', level: 3, hp: 115, spoils: 'Thunder Flare', isLeader: true }, { unit: 'Soldier [M]', level: 2, hp: 139, spoils: 'Stone of Swiftness' }, { unit: 'Soldier [M]', level: 2, hp: 136, spoils: 'Healing Leaf' }, { unit: 'Soldier [M]', level: 2, hp: 136, spoils: 'Short Bow' } ], guests: [ { name: 'Rictor [M]', level: 4, hp: 181 }, { name: 'Orson [M]', level: 3, hp: 121 } ], strategy: [ "Before the battle, Ivanna can provide a tutorial on the game's elemental system. Knights in this game can use low-level virtue spells, making Ivanna a capable secondary healer.", "<strong>Reinforcements Arrive:</strong> On Turn 3, Rictor and Orson will appear on the eastern side of the map, providing significant support and an additional healer.", "<strong>Terrain Advantage:</strong> The enemy wizard uses lightning magic. Keep your units on Stone Floor or Ground terrain to gain a defensive bonus against lightning-based attacks.", "<strong>Buried Treasure:</strong> There is a Dragon Shield at coordinate [15,2] and a Claymore or Great Bow at [7,12]. The Dragon Shield requires a flying or water-walking unit to reach. You can return here later in Training Mode with appropriate units (like a Ninja or Hawkman) to collect these items." ], aftermath: `<p>After the battle, you will receive <strong>3500 Goth</strong>. The Shop, Organize, and Training options become available on the world map, and the units determined by the Tarot reading will join your party.</p><ul class="list-disc list-inside space-y-3 pl-2 mt-4"><li><strong>Recruiting:</strong> You can now hire new units. Hawkmen are highly recommended if available due to their flight capability. Consider starting the process to recruit the unique character Deneb.</li><li><strong>Class Management:</strong> It is advisable to temporarily change Alphonse and other male soldiers to the Beast Tamer class and then back. This class can become permanently unavailable if you defeat 5 beast-type units before accessing it.</li><li><strong>Looting Tip:</strong> A profitable strategy is to persuade enemy units to join you, strip them of their equipment, and then dismiss them from your party. You can sell their gear for extra Goth.</li></ul>` },
        // Battle 3
        { id: 'wk03', chapter: 'Chapter 1', name: 'Vespa', difficulty: '3/10', mapSize: '14x18', winCondition: 'Defeat the leader (Archer)', deployment: { player: 'Up to 6', guest: '1', enemy: '7' }, enemies: [ { unit: 'Archer [L]', level: 6, hp: 142, spoils: 'Great Bow', isLeader: true }, { unit: 'Bandit', level: 5, hp: 164, spoils: 'Stone of Swiftness' }, { unit: 'Bandit', level: 5, hp: 163, spoils: 'Cup of Life' }, { unit: 'Soldier', level: 5, hp: 163, spoils: 'Healing Leaf' }, { unit: 'Soldier', level: 5, hp: 163, spoils: 'Sword Emblem' }, { unit: 'Soldier', level: 5, hp: 167, spoils: 'Healing Leaf' }, { unit: 'Soldier', level: 5, hp: 160, spoils: 'Crown of Intellect' } ], guests: [ { name: 'Ivanna', level: 4, hp: 155 } ], strategy: [ "This battle features no magic users, so elemental resistances from terrain are not a factor. Sticking together is a viable strategy.", "One soldier is equipped with a Long Sword, which is a good item to obtain via persuasion if you haven't found a Claymore yet.", "Keep an eye on your units' health, as it's possible for one to be quickly overwhelmed. Have healing items ready.", "Archers are more effective from high ground. Force them downhill to reduce their range and effectiveness." ], aftermath: `<p>After the battle, you have the option to let Ivanna join your party permanently. It's recommended to accept her offer. Note that if you change her class, she cannot become a Knight again until her stats are high enough.</p><ul class="list-disc list-inside space-y-3 pl-2 mt-4"><li><strong>Glycinia Sighting #1:</strong> A special fairy can be encountered in a random battle at Vespa before proceeding to Formido.</li><li><strong>Buried Treasure:</strong> A Glass Pumpkin can be found at tile [06,03].</li><li><strong>Class Management:</strong> Check if any female characters can become Dragon Tamers. This class is easily locked out if you kill a dragon before changing into it.</li></ul>` },
        // Battle 4
        { id: 'wk04', chapter: 'Chapter 1', name: 'Formido', difficulty: '3.5/10', mapSize: '13x13', winCondition: 'Defeat the leader (Knight)', deployment: { player: 'Up to 6', guest: '0', enemy: '8' }, enemies: [ { unit: 'Knight [L]', level: 8, hp: 180, spoils: 'Chain Mail', isLeader: true }, { unit: 'Soldier', level: 6, hp: 171, spoils: 'Healing Leaf' }, { unit: 'Soldier', level: 6, hp: 170, spoils: 'Cup of Life' }, { unit: 'Soldier', level: 6, hp: 165, spoils: 'Sword Emblem' }, { unit: 'Archer', level: 6, hp: 148, spoils: 'Stone of Swiftness' }, { unit: 'Archer', level: 6, hp: 139, spoils: 'Crown of Intellect' }, { unit: 'Cleric', level: 6, hp: 134, spoils: 'Cleanse (S)' }, { unit: 'Wizard', level: 6, hp: 129, spoils: 'Crag Crush (S)' } ], strategy: [ "The castle wall provides a great tactical advantage. Knocking enemies off the wall with a shield bash can be an effective way to eliminate them.", "The Wizard and Cleric drop the Crag Crush and Cleanse spells, which are not yet available in shops. Defeat them to obtain these valuable spells.", "The enemy cleric tends to prioritize healing the leader. Use this to your advantage by luring her away from other enemies.", "A Dragon Gem Sword is buried at tile [12,12]." ], aftermath: `After some story scenes, you'll be employed by Cybil Alinda. The path to Ardea is now open.<ul class="list-disc list-inside space-y-3 pl-2 mt-4"><li>The Numida Chronology, obtained from this battle, unlocks Quest Mode.</li><li>Shops are updated with new items and area-effect spells.</li></ul>` },
        // Battle 5
        { id: 'wk05', chapter: 'Chapter 1', name: 'Ardea', difficulty: '3/10', mapSize: '18x14', winCondition: 'Defeat all enemies', deployment: { player: 'Up to 6', guest: '1', enemy: '7' }, enemies: [ { unit: 'Griffin', level: 7, hp: 178, spoils: 'Cup of Life' }, { unit: 'Griffin', level: 7, hp: 177, spoils: 'Savage Bugle' }, { unit: 'Hawkman', level: 7, hp: 166, spoils: 'Sorceror\'s Cup' }, { unit: 'Hawkman', level: 7, hp: 161, spoils: 'Sword Emblem' }, { unit: 'Hawkman', level: 7, hp: 156, spoils: 'Crown of Intellect' }, { unit: 'Fairy', level: 7, hp: 122, spoils: 'Stone of Swiftness' }, { unit: 'Fairy', level: 7, hp: 117, spoils: 'Healing Leaf' } ], guests: [{name: 'Cybil', level: 6, hp: 155}], strategy: [ "This is a swamp map, which will impede the movement of most ground units. Flying units like Hawkmen and Ninjas are very effective here.", "The enemies are all flying types, making them difficult to surround. Spells with 100% accuracy like Thunder Blade and Ice Field are recommended.", "Cybil is very powerful and can defeat enemies quickly. Try to get your own units involved to gain experience.", "One Hawkman drops a Sorcerer's Cup, which permanently increases max MP. Prioritize obtaining this item." ], aftermath: "Proceed to Urodela. If you have recruited Deneb, the secret shop in Scabellum will now be permanently open." },
        // Battle 6
        { id: 'wk06', chapter: 'Chapter 1', name: 'Urodela', difficulty: '3/10', mapSize: '13x11', winCondition: 'Defeat the leader (Ninja)', deployment: { player: 'Up to 6', guest: '1', enemy: '7' }, enemies: [ { unit: 'Ninja [L]', level: 9, hp: 163, spoils: 'Katzbalger', isLeader: true }, { unit: 'Ninja', level: 7, hp: 154, spoils: 'Sword Emblem' }, { unit: 'Ninja', level: 7, hp: 151, spoils: 'Cup of Life' }, { unit: 'Ninja', level: 7, hp: 151, spoils: 'Necklace of Resist' }, { unit: 'Ninja', level: 7, hp: 149, spoils: 'Altar of Resurrection' }, { unit: 'Ninja', level: 7, hp: 147, spoils: 'Healing Seed' }, { unit: 'Witch', level: 7, hp: 140, spoils: 'Magic Seed' } ], guests: [{name: 'Cybil', level: 7, hp: 159}], strategy: [ "Ninjas have high agility and movement. Use status effects like Sleep or Paralysis to control them.", "The enemy Witch can inflict Charm and Sleep. She is a high-priority target. She also carries a Spell Robe, which you can get by persuading her.", "One ninja has a Necklace of Resist, which nullifies all magic damage. This is an excellent accessory for non-magic units.", "A Hyacinth Fan is buried at tile [3,13]." ], aftermath: `This is a major story branch.<br>Choose <strong>"I've no better ideas..."</strong> for Path A (Bison).<br>Choose <strong>"It doesn't seem right."</strong> for Path B (Sufrir).` },
        // Battle 7A
        { id: 'wk7a', chapter: 'Chapter 1 (Path A)', name: 'Bison', difficulty: '3.5/10', mapSize: '13x19', winCondition: 'Defeat all enemies', deployment: { player: 'Up to 6', guest: '0', enemy: '7' }, enemies: [ { unit: 'Fairy', level: 10, hp: 128, spoils: 'Sword Emblem' }, { unit: 'Fairy', level: 10, hp: 127, spoils: 'Crown of Intellect' }, { unit: 'Hawkman', level: 10, hp: 181, spoils: 'Healing Seed' }, { unit: 'Hawkman', level: 10, hp: 197, spoils: 'Tower Shield' }, { unit: 'Hawkman', level: 10, hp: 189, spoils: 'Antidote' }, { unit: 'Blue Dragon', level: 10, hp: 218, spoils: 'Coral Harp' }, { unit: 'Blue Dragon', level: 10, hp: 217, spoils: 'Dragon Eyes' } ], strategy: [ "The swampy terrain will slow down most of your units. Flying and floating units have a major advantage.", "It is a good strategy to remain near your starting position, forcing the enemies to engage you on dry land.", "Avoid fighting in the water, as it incurs attack and defense penalties." ], aftermath: `Shiven, a ninja, will ask to join your party. Accepting his offer gets you the rare Kagari-bi katana. Equip the Dragon Eyes accessory on a key unit like a healer.` },
        // Battle 7B
        { id: 'wk7b', chapter: 'Chapter 1 (Path B)', name: 'Sufrir', difficulty: '4/10', mapSize: '11x18', winCondition: 'Defeat all enemies', deployment: { player: 'Up to 6', guest: '1', enemy: '7' }, enemies: [ { unit: 'Earth Dragon', level: 11, hp: 207, spoils: 'Crown of Intellect' }, { unit: 'Earth Dragon', level: 11, hp: 214, spoils: 'Mirror of the Gods' }, { unit: 'Thunder Dragon', level: 11, hp: 220, spoils: 'Cup of Life' }, { unit: 'Thunder Dragon', level: 11, hp: 225, spoils: 'Sword Emblem' }, { unit: 'Gremlin', level: 11, hp: 151, spoils: 'Sorceror\'s Cup' }, { unit: 'Gremlin', level: 11, hp: 153, spoils: 'Stone of Swiftness' }, { unit: 'Gremlin', level: 11, hp: 151, spoils: 'Stone of Swiftness' } ], guests: [{name: 'Orson', level: 8, hp: 153}], strategy: [ "Before the battle, your conversation with Eleanor can affect a future item reward. Choose \"Of course I'll be back.\" for the best outcome.", "Dragons are powerful. Use magic and ranged attacks to weaken them before engaging in close combat.", "Gremlins have high evasion. Use 100%-hit-rate magic or flying units to deal with them.", "Orson is not a special guest; if he is defeated and not revived, he is lost permanently.", "An Ice Wand is buried at the clifftop tile [11,16]." ], aftermath: `You can choose to have Orson permanently join your party. He may be weaker than your other units. Shops have been updated with new items. Glycinia can be encountered at Sufrir.` },
        // Battle 8
        { id: 'wk08', chapter: 'Chapter 1', name: 'Arena', difficulty: '3/10', mapSize: '14x12', winCondition: 'Varies', deployment: { player: 'Up to 6' }, enemies: [ /* Path-dependent */ ], guests: [ /* Path-dependent */ ], strategy: [ "This battle is different depending on your story path. On Path A, you must protect the mermaid Minerva. On Path B, you must defeat all enemies.", "Bringing a unit with the Clear Sky spell can be advantageous, especially on Path B, to remove water tiles.", "On Path A, fortifying your position on the starting island is a good strategy. On Path B, it's more of a defensive measure.", "Prioritize defeating the enemy mermaids on Path B, as their Lullaby skill can be very disruptive." ], aftermath: "No significant aftermath. Proceed to the next battle." },
        // Battle 9
        { id: 'wk09', chapter: 'Chapter 1', name: 'Rana', difficulty: '4.5/10', mapSize: '20x16', winCondition: 'Defeat the leader (Mermaid)', deployment: { player: 'Up to 6' }, enemies: [ { unit: 'Mermaid [L]', level: 15, hp: 208, spoils: '2000 Goth', isLeader: true }, { unit: 'Octopus', level: 13, hp: 237, spoils: 'Cup of Life' }, { unit: 'Octopus', level: 13, hp: 233, spoils: 'Healing Seed' }, { unit: 'Fairy', level: 13, hp: 134, spoils: 'Stone of Swiftness' }, { unit: 'Fairy', level: 13, hp: 142, spoils: 'Cassowary Feather' }, { unit: 'Mermaid', level: 13, hp: 192, spoils: 'Sword Emblem' }, { unit: 'Mermaid', level: 13, hp: 178, spoils: 'Sorceror\'s Cup' }, { unit: 'Mermaid', level: 13, hp: 191, spoils: 'Crown of Intellect' } ], strategy: [ "This map has a lot of water. Use Clear Sky to manage the weather and flooding.", "Waiting on the starting island to lure enemies onto dry land is a sound strategy.", "Ninjas and Hawkmen are very useful for navigating the terrain.", "An Ice Blade is buried at tile [16,01]. This is a very powerful one-handed sword." ], aftermath: `You can have the enemy leader, Aerial, join your party. She has some useful equipment even if you don't plan to use her in battle.` },
        // Battle 10
        { id: 'wk10', chapter: 'Chapter 1', name: 'Solea', difficulty: '4.5/10', mapSize: '21x12', winCondition: 'Protect Eleanor', deployment: { player: 'Up to 6', guest: '1' }, enemies: [ { unit: 'Dragoon [L]', level: 15, hp: 239, spoils: 'Fafnir', isLeader: true }, { unit: 'Fire Dragon', level: 13, hp: 235, spoils: 'Cup of Life' }, { unit: 'Blue Dragon', level: 13, hp: 232, spoils: 'Dragon Eyes' }, { unit: 'Earth Dragon', level: 13, hp: 240, spoils: 'Altar of Resurrection' }, { unit: 'Thunder Dragon', level: 13, hp: 240, spoils: 'Sword Emblem' }, { unit: 'Archer', level: 13, hp: 170, spoils: 'Stone of Swiftness' }, { unit: 'Archer', level: 13, hp: 178, spoils: 'Sherwood Hat' } ], guests: [{name: 'Eleanor', level: 12, hp: 213}], strategy: [ "Your starting position on the high ground provides a significant advantage. Use mages and ranged units to attack from safety.", "The enemy Dragoon can inflict instant death on dragons. Keep any allied dragons away from him.", "The Sherwood Hat dropped by an archer is a unique item. The Dragon Eyes accessory is also very valuable.", "The primary objective is to protect Eleanor. If her HP reaches zero, you lose the battle. Keep a healer nearby to support her." ], aftermath: `You can have Eleanor join you as a non-playable companion. Agreeing will lead to a better item reward later. Shops are updated with new equipment and powerful spells like Haste and Heal Plus.` },
        // Battle 11
        { id: 'wk11', chapter: 'Chapter 2', name: 'Aquila', difficulty: '3/10', mapSize: '17x15', winCondition: 'Defeat all enemies', deployment: { player: 'Up to 6', guest: '1' }, enemies: [ { unit: 'Hawkman', level: 14, hp: 224, spoils: 'Sorceror\'s Cup' }, { unit: 'Hawkman', level: 14, hp: 210, spoils: 'Healing Seed' }, { unit: 'Cerberus', level: 14, hp: 220, spoils: 'Cup of Life' }, { unit: 'Red Dragon', level: 14, hp: 251, spoils: 'Mirror of the Gods' }, { unit: 'Red Dragon', level: 14, hp: 240, spoils: 'Sword Emblem' }, { unit: 'Gremlin', level: 14, hp: 164, spoils: 'Stone of Swiftness' }, { unit: 'Gremlin', level: 14, hp: 160, spoils: 'Crown of Intellect' } ], guests: [{name: 'Eleanor', level: 13, hp: 220}], strategy: [ "The allies start on high ground, providing a natural advantage. Use the lava rivulets as borders to control enemy movement.", "Eleanor may act independently. It's wise to send a Knight or another healer with her for support, as she will not heal herself.", "The 'Grueza\'s Influence' spell can be useful here to weaken fire-based enemies.", "The Cerberus introduces the Mesmerize attack, which can inflict sleep.", "A unique Thunder Shield can be obtained by persuading one of the Hawkmen. The Volcaetus spear is buried at tile [02,02]." ], aftermath: `The "Epic of Tinea" book for Quest Mode is unlocked. During the scenes, choosing the second dialogue option ("I need it to make a world where...") is required for a unique item from Eleanor later. You will then have the option to let Eleanor join your party permanently.` },
        // Battle 12
        { id: 'wk12', chapter: 'Chapter 2 (Optional)', name: 'Gryllus', difficulty: '6/10', mapSize: '13x20', winCondition: 'Eradicate all enemies', deployment: { player: 'Up to 8' }, enemies: [ { unit: 'Ghost', level: 14, hp: 184, spoils: 'N/A' }, { unit: 'Ghost', level: 14, hp: 181, spoils: 'N/A' }, { unit: 'Undead Soldier', level: 14, hp: 188, spoils: 'N/A' }, { unit: 'Undead Soldier', level: 14, hp: 186, spoils: 'N/A' }, { unit: 'Undead Soldier', level: 14, hp: 185, spoils: 'N/A' }, { unit: 'Undead Soldier', level: 14, hp: 185, spoils: 'N/A' }, { unit: 'Undead Wizard', level: 14, hp: 157, spoils: 'N/A' }, { unit: 'Undead Wizard', level: 14, hp: 158, spoils: 'N/A' } ], strategy: [ "This map features a continuous stream of undead reinforcements. It is highly recommended to bring at least one Cleric or Priest with the Exorcism and Faith abilities.", "Using healing items on undead units will damage them, which can be a very effective strategy.", "Flying or teleporting units are excellent for luring enemies into a group for a mass Exorcism.", "Do not let the river flood. Use the 'Clear Sky' spell if it starts to rain. Keep non-teleporting mages out of the ravine.", "Eleanor's 'Star Tiara' skill (requires 170 INT) can banish all undead on the map instantly.", "A Glass Pumpkin is buried at tile [5,7]." ], aftermath: "Clearing this map opens the path to Blete. Replaying Gryllus is a good way to farm Sorceror's Cups." },
        // Battle 13
        { id: 'wk13', chapter: 'Chapter 2 (Optional)', name: 'Blete', difficulty: '4/10', mapSize: '17x13', winCondition: 'Defeat the leader (Shaman)', deployment: { player: 'Up to 8' }, enemies: [ { unit: 'Shaman [L]', level: 16, hp: 172, spoils: 'Salamander (Summon)', isLeader: true }, { unit: 'Warlock', level: 14, hp: 215, spoils: 'Sword Emblem' }, { unit: 'Undead Wizard', level: 14, hp: 160, spoils: 'N/A' }, { unit: 'Undead Wizard', level: 14, hp: 159, spoils: 'N/A' }, { unit: 'Dragon Zombie', level: 14, hp: 243, spoils: 'N/A' }, { unit: 'Undead Knight', level: 14, hp: 204, spoils: 'N/A' }, { unit: 'Undead Knight', level: 14, hp: 202, spoils: 'N/A' }, { unit: 'Undead Knight', level: 14, hp: 197, spoils: 'N/A' } ], strategy: [ "The enemy leader, Euphaire, can use the powerful Salamander summon. Her Warlock ally will use Fluid Magic to restore her MP, so prioritize defeating the Warlock.", "This is a rare opportunity to persuade a Dragon Zombie. Its Rotting Breath attack is very useful.", "Be mindful of unit placement, as the houses can trap slower units, keeping them out of the main fight.", "Defeating the leader, Euphaire, will end the battle." ], aftermath: "You can have Euphaire, a unique Shaman, join your party. It is highly recommended to recruit her." },
        // Battle 14
        { id: 'wk14', chapter: 'Chapter 2', name: 'Vespa [II]', difficulty: '3/10', mapSize: '14x18', winCondition: 'Defeat the leader (Beast Tamer)', deployment: { player: 'Up to 8' }, enemies: [ { unit: 'Beast Tamer [L]', level: 17, hp: 224, spoils: 'Beast Whip', isLeader: true }, { unit: 'Griffin', level: 15, hp: 242, spoils: 'Stone of Swiftness' }, { unit: 'Griffin', level: 15, hp: 241, spoils: 'Crown of Intellect' }, { unit: 'Cockatrice', level: 15, hp: 230, spoils: 'Urn of Chaos' }, { unit: 'Cockatrice', level: 15, hp: 228, spoils: 'Tome of Discipline' }, { unit: 'Cerberus', level: 15, hp: 229, spoils: 'Wisdom Fruit' }, { unit: 'Cerberus', level: 15, hp: 226, spoils: 'Sword Emblem' }, { unit: 'Cerberus', level: 15, hp: 225, spoils: 'Cup of Life' } ], strategy: [ "The enemy leader boosts the mental gauge of his allied beasts.", "The Cockatrices are the main threat, as they can inflict petrification. Target them first.", "The monsters will use their special attacks frequently. Keep your units spread out to minimize group damage.", "If you have a summoner like Euphaire, use Fluid Magic to fuel their powerful spells." ], aftermath: "Naja is the next destination, but the optional map Belleza is also available. Glycinia will reappear at Vespa with the unique Holy Comet whip if you wish to recruit her." },
        // Battle 15
        { id: 'wk15', chapter: 'Chapter 2 (Optional)', name: 'Belleza', difficulty: '4/10', mapSize: '14x12', winCondition: 'Defeat the leader (Summoner)', deployment: { player: 'Up to 8' }, enemies: [ { unit: 'Summoner [L]', level: 17, hp: 202, spoils: 'Fenrir (Summon)', isLeader: true }, { unit: 'Valkyrie', level: 15, hp: 198, spoils: 'Trident' }, { unit: 'Valkyrie', level: 15, hp: 196, spoils: 'Plumed Headband' }, { unit: 'Ninja', level: 15, hp: 191, spoils: 'Warp Shoes' }, { unit: 'Ninja', level: 15, hp: 191, spoils: 'Sword Emblem' }, { unit: 'Ninja', level: 15, hp: 190, spoils: 'Stone of Swiftness' }, { unit: 'Witch', level: 15, hp: 179, spoils: 'Spell Robe' }, { unit: 'Witch', level: 15, hp: 176, spoils: 'Pointy Hat' } ], strategy: [ "The terrain is difficult for ground units. Ninja and Hawkmen are highly recommended.", "One ninja has Warp Shoes, an excellent item that allows a unit to teleport. Prioritize obtaining them.", "The enemy summoner, Elrik, will use his Fenrir summon. Target his support witch to cut off his MP supply.", "A Snapdragon item is buried at tile [0,11]. This is a rare item used to create powerful swords." ], aftermath: "You can recruit Elrik, a unique Summoner. Like Euphaire, he is a very powerful and versatile magic user." },
        // Battle 16
        { id: 'wk16', chapter: 'Chapter 2', name: 'Naja', difficulty: '3.5/10', mapSize: '22x16', winCondition: 'Defeat the leader (Siren)', deployment: { player: 'Up to 8' }, enemies: [ { unit: 'Siren [L]', level: 18, hp: 203, spoils: 'Gnome (summon)', isLeader: true }, { unit: 'Wizard', level: 16, hp: 173, spoils: 'Earth Wand' }, { unit: 'Wizard', level: 16, hp: 172, spoils: 'Ice Wand' }, { unit: 'Knight', level: 16, hp: 234, spoils: 'Earth Shield' }, { unit: 'Knight', level: 16, hp: 234, spoils: 'Sword Emblem' }, { unit: 'Soldier', level: 16, hp: 248, spoils: 'Stone of Swiftness' }, { unit: 'Cleric', level: 16, hp: 185, spoils: 'Cleanse (spell)' }, { unit: 'Witch', level: 16, hp: 186, spoils: 'Water Garb' } ], strategy: [ "The enemy leader, Grevis, uses the Gnome summon. The witch with Fluid Magic should be your first target to prevent this.", "Surround enemies one by one. The enemy cleric only has Heal Plus and will not heal a unit if it means healing your own.", "Grevis's fan can inflict Charm. Attack her from a distance or from behind.", "The leader is fire-elemental but uses an earth summon, making it weaker than it could be. Stay on grass tiles to avoid giving it a terrain bonus." ], aftermath: "Nothing of note. Proceed to Sotavento." },
        // Battle 17
        { id: 'wk17', chapter: 'Chapter 2', name: 'Sotavento', difficulty: '4/10', mapSize: '14x13', winCondition: 'Defeat the leader (Esquire)', deployment: { player: 'Up to 8' }, enemies: [ { unit: 'Esquire [L]', level: 19, hp: 265, spoils: '1000 Goth', isLeader: true }, { unit: 'Knight', level: 17, hp: 245, spoils: 'Sword Emblem' }, { unit: 'Knight', level: 17, hp: 237, spoils: 'Sword Emblem' }, { unit: 'Valkyrie', level: 17, hp: 207, spoils: 'Altar of Resurrection' }, { unit: 'Valkyrie', level: 17, hp: 200, spoils: 'Stone of Swiftness' }, { unit: 'Valkyrie', level: 17, hp: 200, spoils: 'Stone of Swiftness' }, { unit: 'Priest', level: 17, hp: 193, spoils: 'Resurrection (spell)' } ], strategy: [ "The enemy leader, Nichart, prefers to attack from a distance with Ice Javelin.", "The enemy witch can cast Fascination. Defeat her quickly.", "The Priest carries the unique Resurrection spell (on Path A). He can be persuaded to join, which is useful for the upcoming split-party battles.", "A Snapdragon item is buried at tile [12,0]." ], aftermath: "Eleanor gives you her Pearl Necklace, which prevents status effects. Fluid Magic and Full Heal are now available in shops." },
        // Battle 18
        { id: 'wk18', chapter: 'Chapter 2', name: 'Haena', difficulty: '5/10', mapSize: '18x12', winCondition: 'Defeat the leader', deployment: { player: 'Up to 8' }, enemies: [ /* Varies by Path */ ], strategy: [ "The enemy lineup is different depending on your story path. Path A features Archers and Ninjas. Path B features heavy-hitting Knights and Dragoons.", "On Path B, the enemies are very defensive. Use summons and surround tactics. Molten Blade is also effective.", "The terrain makes it difficult for mage units to get into position. Use flying or high-movement units to your advantage.", "On Path B, the enemy leader can banish undead units, making them less effective here unless they have a Necklace of Resist.", "Many rare items are dropped in this battle. On Path A, look for the unique Forest Boots and Teleport spell. On Path B, look for the Dragon Armor." ], aftermath: "Two new locations open: the mandatory Ostorea Castle and the optional Gracula. Ostorea involves four consecutive battles, so prepare accordingly. Glycinia will reappear at Haena with Ripple's Staff." },
        // Battle 19
        { id: 'wk19', chapter: 'Chapter 2 (Optional)', name: 'Gracula', difficulty: '2/10', mapSize: '16x22', winCondition: 'Defeat all enemies', deployment: { player: 'Up to 8' }, enemies: [ /* Varies by Glycinia */ ], strategy: [ "This battle's main purpose is for Glycinia's sidequest. If she is in your party, the enemy lineup will be different and her sister, Lubina, will appear as a Gremlin named 'Lubinnya'.", "To recruit Lubina, move Glycinia next to her. Lubina will not attack.", "Defeat all other enemies first, then trigger the event with Glycinia to safely finish the battle.", "If Glycinia is not in your party, you will face a standard group of Gremlins." ], aftermath: "If the conditions are met, you can recruit Lubina. She and Glycinia can perform a unique double attack, Magic Missile." },
        // Battle 20
        { id: 'wk20', chapter: 'Chapter 2 (Optional)', name: 'Ostorea Preparations', difficulty: 'N/A', mapSize: 'N/A', winCondition: 'N/A', deployment: { player: 'N/A' }, enemies: [], strategy: [ "This is not a battle, but a preparation guide for the upcoming series of four consecutive fights in Ostorea Castle.", "The first two battles require you to split your party. You cannot save between these fights.", "It's possible to skip one of the gate battles by deploying all your units into the other, but this is not recommended as you will miss out on items and a special skill.", "Consider using undead units (Ghosts, Dragon Zombies with a Necklace of Resist) to 'pad' one of your teams, as they are self-sufficient and can't be banished by the enemies in the first three battles.", "It is recommended to have a unit with Teleport or Hurdle Wall for the Ostorea West battle to deal with archers on the castle wall." ], aftermath: "Divide your troops and prepare for the assault on Ostorea Castle." },
        // Battle 21
        { id: 'wk21', chapter: 'Chapter 3', name: 'Ostorea West', difficulty: '7/10', mapSize: '23x16', winCondition: 'Defeat the leader (Swordmaster)', deployment: { player: 'Varies' }, enemies: [ { unit: 'Swordmaster [L]', level: 21, hp: 264, spoils: 'Notos', isLeader: true }, { unit: 'Archer', level: 19, hp: 218, spoils: 'Grincer Coat' }, { unit: 'Archer', level: 19, hp: 215, spoils: 'Stone of Swiftness' }, { unit: 'Warlock', level: 19, hp: 242, spoils: 'Sacred Ring' }, { unit: 'Duke Knight', level: 19, hp: 270, spoils: 'Saint\'s Shield' }, { unit: 'Duke Knight', level: 19, hp: 274, spoils: 'Sum Mannus' }, { unit: 'Hawkman', level: 19, hp: 245, spoils: 'Healing Salve' }, { unit: 'Hawkman', level: 19, hp: 238, spoils: 'Crown of Intellect' } ], strategy: [ "This is one of two gate battles where your party is split. It's considered the harder of the two.", "The leader, Margret, has the powerful Atropos skill, which can deal over 100 damage but also damages her. Keep mages away from her.", "Prioritize defeating the two Duke Knights near the gate first. Lure them into the water to lower their defense.", "Use flying or teleporting units to take out the archers on the castle walls. The Grincer Coat is part of a rare set, but not unique.", "Use a high-HP unit as bait to draw out Margret's Atropos attack, which will weaken her and make her easier to defeat." ], aftermath: `After the battle, you will learn the special skill 'Atropos' and can teach it to any one human character in your entire army. This is your only chance to learn this skill.` },
        // Battle 22
        { id: 'wk22', chapter: 'Chapter 3', name: 'Ostorea South', difficulty: '4/10', mapSize: '22x15', winCondition: 'Defeat the leader (Esquire)', deployment: { player: 'Varies' }, enemies: [ { unit: 'Esquire [L]', level: 22, hp: 298, spoils: 'Osric\'s Spear', isLeader: true }, { unit: 'Siren', level: 20, hp: 202, spoils: 'Cloak of Authority' }, { unit: 'Siren', level: 20, hp: 201, spoils: 'Caldia' }, { unit: 'Witch', level: 20, hp: 201, spoils: 'Stone of Swiftness' }, { unit: 'Priest', level: 20, hp: 201, spoils: 'Divine Radiance (spell)' }, { unit: 'Duke Knight', level: 20, hp: 280, spoils: 'Healing Salve' }, { unit: 'Duke Knight', level: 20, hp: 268, spoils: 'Firedrake Sword' }, { unit: 'Venefica', level: 20, hp: 240, spoils: '1000 Goth' } ], strategy: [ "The Priest holds the unique 'Divine Radiance' spell. Prioritize persuading or defeating her to obtain it.", "The Venefic (Lethe) will use Fluid Magic to support the Priest. Take her out early.", "Draw the Duke Knights towards your party and use summons and surround tactics to defeat them.", "The leader, Nichart, is agile and uses ice attacks. Surround him to limit his two-panel attack range.", "A Leviathan Mail is buried at tile [0,15]." ], aftermath: "Your split parties will now rejoin for the assault on the throne room." },
        // Battle 23
        { id: 'wk23', chapter: 'Chapter 3', name: 'Ostorea Throne Room', difficulty: '3/10', mapSize: '12x19', winCondition: 'Defeat the leader (High Priest)', deployment: { player: 'Up to 8' }, enemies: [ { unit: 'High Priest [L]', level: 22, hp: 294, spoils: '1000 Goth', isLeader: true }, { unit: 'Wizard', level: 20, hp: 195, spoils: 'Water Garb' }, { unit: 'Wizard', level: 20, hp: 195, spoils: 'Sorceror\'s Cup' }, { unit: 'Witch', level: 20, hp: 204, spoils: 'Petrifying Cloud (spell)' }, { unit: 'Knight', level: 20, hp: 259, spoils: 'Dragon Helm' }, { unit: 'Knight', level: 20, hp: 268, spoils: 'Dragon Shield' }, { unit: 'Duke Knight', level: 20, hp: 280, spoils: 'Warp Ring' }, { unit: 'Duke Knight', level: 20, hp: 282, spoils: 'Sword Emblem' } ], strategy: [ "The main prizes here are the one-of-a-kind Petrifying Cloud spell and the unique Dragon Helm.", "Target the enemy Witch first. She uses Fluid Magic to power up the leader, Rictor, and can use her petrification spell.", "Rictor himself is not very threatening and mainly uses a basic Heal spell. He is vulnerable to physical attacks.", "Use status effects on the Duke Knight, as his ability to warp makes him difficult to surround." ], aftermath: "The final chamber of Ostorea awaits." },
        // Battle 24
        { id: 'wk24', chapter: 'Chapter 3', name: 'Ostorea Crypt', difficulty: '4.5/10', mapSize: '17x14', winCondition: 'Defeat the leader', deployment: { player: 'Up to 8' }, enemies: [ /* Path-dependent */ ], guests: [], strategy: [ "The final battle of the chapter. The enemy leader and forces differ based on your story path.", "On Path A, you face Rictor again. His Warlock provides MP for his powerful Ignis Fatuus summon. Take the Warlock out with Atropos. Do not bring undead units, as the enemy Angel Knights can banish them.", "On Path B, you face General Naris. He has extremely high defense and a special skill, 'Hell's Gate,' that can inflict instant death. Keep mages far away from him.", "A Ring of the Dead is buried at tile [12,8]. This is a rare item required to create a Lich." ], aftermath: "Chapter 2 ends. Ostorea Castle is now a friendly territory. You can permanently recruit Cybil (Path A) or Rictor (Path B); refusing means you lose their unique summon spell forever. New items are in shops, and new sidequests are available." },
        // Battle 25
        { id: 'wk25', chapter: 'Chapter 3 (Optional)', name: 'Rebanada', difficulty: '3/10', mapSize: '16x13', winCondition: 'Varies', deployment: { player: 'Up to 8' }, enemies: [ /* Varies by visit */ ], strategy: [ "This optional map can be played twice with different outcomes.", "First visit: You will fight a mix of undead units. The leader, Rimmon, has extremely high physical defense; use magic to defeat him. A Dragon Zombie with a Necklace of Resist can be persuaded. A unique Tathlum crossbow is buried at [15,02].", "Second visit: This battle allows you to recruit the unique daemon, Saia. The Vrtra enemies are great persuasion targets. One drops a Snapdragon. To recruit Saia, choose 'I fight for myself.' after the battle." ], aftermath: "Recruiting Saia prevents you from recruiting the Angel Knight Lobelia, and vice-versa. You can recruit one, strip their gear, dismiss them, and then recruit the other." },
        // Battle 26
        { id: 'wk26', chapter: 'Chapter 3', name: 'Harmonia', difficulty: '4.5/10', mapSize: '17x21', winCondition: 'Defeat both leaders', deployment: { player: 'Up to 8' }, enemies: [ { unit: 'Venefic [L]', level: 27, hp: 283, spoils: 'Fiend\'s Grip (S)', isLeader: true }, { unit: 'Venefica [L]', level: 27, hp: 276, spoils: 'Sugar Cane', isLeader: true }, { unit: 'Giant', level: 25, hp: 341, spoils: 'Snapdragon' }, { unit: 'Giant', level: 25, hp: 346, spoils: 'Wind Ring' }, { unit: 'Daemon', level: 25, hp: 279, spoils: 'Boreas' }, { unit: 'Daemon', level: 25, hp: 282, spoils: 'Ring of the Dead' }, { unit: 'Gorgon', level: 25, hp: 259, spoils: 'Sandstorm Bow' }, { unit: 'Gorgon', level: 25, hp: 267, spoils: 'Urn of Chaos' } ], strategy: [ "You must defeat both leaders. The snowy terrain will hinder movement, so flying or teleporting units are key.", "The male leader, Cirvante, can summon more undead units. Target him first.", "The Gorgons can petrify units without shields. Make them a priority.", "The leaders have high AGI, making them difficult to hit with physical attacks. Use 100% accuracy spells or attack from behind.", "Valuable drops include the unique Boreas axe, a Ring of the Dead, and a Snapdragon." ], aftermath: "The path to the mountains at Charadrius opens." },
        // Battle 27
        { id: 'wk27', chapter: 'Chapter 3', name: 'Charadrius', difficulty: '4.5/10', mapSize: '14x19', winCondition: 'Defeat the leader', deployment: { player: 'Up to 8' }, enemies: [ /* Varies by Path */ ], strategy: [ "Path A: You face Naris Batraal again. His Hell's Gate skill is very dangerous. Target his two Priests to neutralize his healing support. One Priest has the unique Divine Radiance spell.", "Path B: You face a former ally. The main threats are Angel Knights who can banish undead. Do not deploy any. The witch drops the unique Time Flux spell, and a daemon drops the unique Euros hammer.", "On both paths, the terrain is mountainous, favoring flying units and ranged attackers." ], aftermath: "On Path B, you obtain the Longicolnis spear, which is required for one of the endings. This is the last chance to recruit Glycinia for her best equipment (Crescente bow)." },
        // Battle 28
        { id: 'wk28', chapter: 'Chapter 3', name: 'Angel\'s Headstone', difficulty: '3/10', mapSize: '23x13', winCondition: 'Defeat the leader (Lich)', deployment: { player: 'Up to 8' }, enemies: [ { unit: 'Lich [L]', level: 30, hp: 256, spoils: 'N/A', isLeader: true }, { unit: 'Daemon', level: 29, hp: 317, spoils: 'Urn of Chaos' }, { unit: 'Undead Knight', level: 29, hp: 291, spoils: 'N/A' }, { unit: 'Undead Knight', level: 29, hp: 290, spoils: 'N/A' }, { unit: 'Undead Wizard', level: 29, hp: 199, spoils: 'N/A' }, { unit: 'Ghost', level: 29, hp: 250, spoils: 'N/A' }, { unit: 'Ghost', level: 29, hp: 251, spoils: 'N/A' }, { unit: 'Dragon Zombie', level: 29, hp: 349, spoils: 'N/A' } ], strategy: [ "The enemy leader is a Lich with extremely high defenses. Use your most powerful attacks like Atropos and summons.", "The Dragon Zombie has a Necklace of Resist, making it immune to magic. It can only be killed by Banish (Angel Knight) or Star Tiara (Eleanor).", "The Daemon can summon more undead. Defeat it early.", "If you are having trouble dealing enough damage to the Lich, use the Time Flux spell to grant your strongest attacker an extra turn." ], aftermath: "You must split your party again for the next two battles. One party goes to the Hall of Corruption, the other to the Garden of Memories." },
        // Battle 29
        { id: 'wk29', chapter: 'Chapter 3', name: 'Hall of Corruption', difficulty: '3/10', mapSize: '15x21', winCondition: 'Defeat the leader (Daemon)', deployment: { player: 'Varies' }, enemies: [ { unit: 'Daemon [L]', level: 31, hp: 317, spoils: 'N/A', isLeader: true }, { unit: 'Dark Angel', level: 29, hp: 302, spoils: 'Healing Essence' }, { unit: 'Dark Angel', level: 29, hp: 317, spoils: 'Angel Fruit' }, { unit: 'Gorgon', level: 29, hp: 290, spoils: 'Crown of Intellect' }, { unit: 'Gorgon', level: 29, hp: 284, spoils: 'Crown of Intellect' }, { unit: 'Swordmaster', level: 29, hp: 289, spoils: 'Stone of Swiftness' }, { unit: 'Swordmaster', level: 29, hp: 292, spoils: 'Spirit Fruit' }, { unit: 'Vrtra', level: 29, hp: 368, spoils: 'Sword Emblem' } ], strategy: [ "This is the easier of the two split battles. Equip shields on your units to protect against the Gorgons' petrifying Evil Eye attack.", "Undead units are very effective here, as Dark Angels cannot banish them.", "The enemy drops are not essential, so feel free to focus all your attacks on the leader to end the battle quickly." ], aftermath: "The units from this battle will wait while your other party clears the next map." },
        // Battle 30
        { id: 'wk30', chapter: 'Chapter 3', name: 'Garden of Memories', difficulty: '4/10', mapSize: '18x18', winCondition: 'Defeat the leader (Angel Knight)', deployment: { player: 'Varies' }, enemies: [ { unit: 'Angel Knight [L]', level: 31, hp: 323, spoils: 'N/A', isLeader: true }, { unit: 'Daemon', level: 29, hp: 302, spoils: 'Cup of Life' }, { unit: 'Daemon', level: 29, hp: 310, spoils: 'Sword Emblem' }, { unit: 'Giant', level: 29, hp: 380, spoils: 'Altar of Resurrection' }, { unit: 'Warlock', level: 29, hp: 315, spoils: 'Amulet' }, { unit: 'Warlock', level: 29, hp: 306, spoils: 'Healing Essence' }, { unit: 'Angel Knight', level: 29, hp: 321, spoils: 'Spirit Fruit' }, { unit: 'Angel Knight', level: 29, hp: 321, spoils: 'Sorceror\'s Cup' } ], strategy: [ "Do not bring undead units, as the Angel Knights can banish them.", "The snowy terrain favors flying and warping units. If you lack these, group your units together for efficient healing.", "Use debilitating status effects like petrify or paralysis to make enemies vulnerable to summons.", "One of the Angel Knights is equipped with the Crescente, the best bow in the game. It can be obtained by persuading this unit.", "If you brought Saia, he will have special dialogue with the enemy leader." ], aftermath: "The two parties rejoin to face the final battles." },
,
        // Battle 31
        { id: 'wk31', chapter: 'Chapter 3', name: 'Hall of Conviction', difficulty: '6/10', mapSize: '22x14', winCondition: 'Defeat the leader (Fallen Angel)', deployment: { player: 'Varies' }, enemies: [ { unit: 'Fallen Angel [L]', level: 31, hp: 454, spoils: 'Anbicion', isLeader: true }, { unit: 'Angel Knight', level: 29, hp: 303, spoils: 'Healing Salve' }, { unit: 'Angel Knight', level: 29, hp: 315, spoils: 'Healing Essence' }, { unit: 'Daemon', level: 29, hp: 302, spoils: 'Crown of Intellect' }, { unit: 'Daemon', level: 29, hp: 300, spoils: 'Orb' }, { unit: 'Daemon', level: 29, hp: 306, spoils: 'Revive Stone' }, { unit: 'Dark Angel', level: 29, hp: 321, spoils: 'Angel Fruit' }, { unit: 'Dark Angel', level: 29, hp: 326, spoils: 'Spirit Fruit' } ], strategy: [ "The units used in this battle must also be used in the final battle. Keep everyone alive.", "The leader, Shaher, has three main abilities: 'Ice Requiem' (a global, sleep-inducing attack), 'Anbicion' (a powerful single-target spell), and 'Descent' (summons reinforcements).", "Don't rush the boss. The flying enemies will intercept you. It's best to advance slowly, picking off the Daemons and Angels as they approach.", "Equip your essential units with accessories that prevent status effects to guard against Ice Requiem's sleep effect.", "Shaher will use Descent to summon reinforcements when his forces dwindle. You can force him to waste turns by defeating the summoned units quickly. Divine Radiance is effective for this.", "Use your strongest abilities like Atropos and summons to wear down Shaher's high defenses. Attacking from behind is recommended." ], aftermath: "The final battle begins immediately with the same units. Ensure everyone has a shield equipped." },
        // Battle 32
        { id: 'wk32', chapter: 'Final', name: 'Nether Region', difficulty: '7/10', mapSize: '11x11', winCondition: 'Defeat the leader (Sacred Demon)', deployment: { player: 'Same as previous' }, enemies: [ { unit: 'Sacred Demon [L]', level: 32, hp: 617, spoils: 'N/A', isLeader: true }, { unit: 'Hell Gigantes', level: 30, hp: 415, spoils: 'N/A' }, { unit: 'Hell Gigantes', level: 30, hp: 418, spoils: 'N/A' }, { unit: 'Dark Stalker', level: 30, hp: 260, spoils: 'N/A' }, { unit: 'Dark Stalker', level: 30, hp: 265, spoils: 'N/A' } ], strategy: [ "This is the final battle. The boss, Shaher, is immobile and has several powerful attacks.", "<strong>IMPORTANT:</strong> Shaher cannot be damaged until he is struck with the <strong>Longicolnis spear</strong>. This must be your first attack against him to break his barrier.", "His 'Day of Reckoning' skill inflicts status effects on all allies. Equipping everyone with a shield or status-preventing accessory nullifies this attack.", "His 'Cataclysm' skill damages ALL units on the field, including his own allies. This can work to your advantage.", "Do not stand adjacent to Shaher, as he has a free counter-attack 'Shear' that does not use up his turn.", "The most effective offensive spell is 'Enfeeble,' as it ignores his high defenses. The Bloody Cleaver has this as an item effect.", "The best strategy is to form a blockade two spaces away from Shaher. Use the character with the Longicolnis to break his barrier, then attack with your strongest skills (Atropos), summons, and especially 'Enfeeble'. Ignore the other enemies unless a Predator is summoned via Descent." ], aftermath: "Congratulations! After the battle, the ending will play based on your previous story choices. The game will create a post-game save file, allowing you to keep playing and revisit Angel's Headstone." }
    ];

    const contentDiv = document.getElementById('walkthrough-content');
    const battleIndexSelect = document.getElementById('battle-index');

    function populateIndex() {
        battles.forEach((battle) => {
            const option = document.createElement('option');
            option.value = battle.id;
            // Use the battle's 'id' for the display text to match the user's index
            option.textContent = `${battle.id}: ${battle.name}`;
            battleIndexSelect.appendChild(option);
        });
    }

    function renderBattle(battleId) {
        const battleIndex = battles.findIndex(b => b.id === battleId);
        if (battleIndex === -1) {
            contentDiv.innerHTML = `<p class="text-center text-red-500">Battle not found.</p>`;
            return;
        }

        const battle = battles[battleIndex];
        battleIndexSelect.value = battle.id;

        const enemiesHtml = battle.enemies.map(e => `<tr class="${e.isLeader ? 'font-bold text-red-400' : ''}"><td class="px-4 py-2">${e.unit}</td><td class="px-4 py-2">${e.level}</td><td class="px-4 py-2">${e.hp}</td><td class="px-4 py-2">${e.spoils}</td></tr>`).join('');
        const guestsHtml = battle.guests ? battle.guests.map(g => `<tr><td class="px-4 py-2">${g.name}</td><td class="px-4 py-2">${g.level}</td><td class="px-4 py-2">${g.hp}</td></tr>`).join('') : '';
        const strategyHtml = battle.strategy.map(s => `<li>${s}</li>`).join('');

        const prevBattle = battles[battleIndex - 1];
        const nextBattle = battles[battleIndex + 1];

        // Handle path split for navigation
        let prevLink, nextLink;
        if (battle.id === 'wk7a' || battle.id === 'wk7b') {
             prevLink = `<a href="#wk06" class="nav-link inline-block battle-nav">&larr; Urodela</a>`;
             nextLink = `<a href="#wk08" class="nav-link inline-block battle-nav">Arena &rarr;</a>`;
        } else {
             prevLink = prevBattle ? `<a href="#${prevBattle.id}" class="nav-link inline-block battle-nav">&larr; ${prevBattle.name}</a>` : `<span class="nav-link disabled">&larr; Previous</span>`;
             nextLink = nextBattle ? `<a href="#${nextBattle.id}" class="nav-link inline-block battle-nav">${nextBattle.name} &rarr;</a>` : `<span class="nav-link disabled">Next &rarr;</span>`;
        }
       
        contentDiv.innerHTML = `
            <header class="text-center mb-8"><p class="text-yellow-400 font-medieval text-xl">Walkthrough: ${battle.chapter}</p><h1 class="font-medieval font-bold text-5xl text-yellow-300">${battle.name}</h1></header>
            <div class="content-container p-6 md:p-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div><h2 class="font-medieval text-2xl text-yellow-400 mb-3">Battle Info</h2><ul class="space-y-2"><li><strong>Difficulty:</strong> ${battle.difficulty}</li><li><strong>Map Size:</strong> ${battle.mapSize}</li><li><strong>Winning Condition:</strong> ${battle.winCondition}</li></ul></div>
                    <div><h2 class="font-medieval text-2xl text-yellow-400 mb-3">Deployment</h2><ul class="space-y-2"><li><strong>Player Units:</strong> ${battle.deployment.player}</li>${battle.deployment.guest ? `<li><strong>Guest Units:</strong> ${battle.deployment.guest}</li>` : ''}<li><strong>Enemy Units:</strong> ${battle.deployment.enemy || battle.enemies.length}</li></ul></div>
                </div>
                <div class="mb-8"><h2 class="font-medieval text-2xl text-yellow-400 mb-3">Enemy Forces</h2><div class="overflow-x-auto rounded-lg border border-gray-700"><table class="w-full text-sm text-left"><thead class="uppercase"><tr><th class="px-4 py-2">Unit</th><th class="px-4 py-2">Level</th><th class="px-4 py-2">HP</th><th class="px-4 py-2">Spoils</th></tr></thead><tbody class="divide-y divide-gray-700">${enemiesHtml}</tbody></table></div></div>
                ${guestsHtml ? `<div class="mb-8"><h2 class="font-medieval text-2xl text-yellow-400 mb-3">Guest Units</h2><div class="overflow-x-auto rounded-lg border border-gray-700"><table class="w-full text-sm text-left"><thead class="uppercase"><tr><th class="px-4 py-2">Name</th><th class="px-4 py-2">Level</th><th class="px-4 py-2">HP</th></tr></thead><tbody class="divide-y divide-gray-700">${guestsHtml}</tbody></table></div></div>` : ''}
                <div><h2 class="font-medieval text-2xl text-yellow-400 mb-3">Strategy</h2><div class="space-y-4 text-gray-300"><ul class="list-disc list-inside space-y-3 pl-2">${strategyHtml}</ul></div></div>
                ${battle.aftermath ? `<div class="mt-8"><h2 class="font-medieval text-2xl text-yellow-400 mb-3">Aftermath</h2><div class="space-y-4 text-gray-300">${battle.aftermath}</div></div>` : ''}
            </div>
            <footer class="text-center mt-8 text-gray-400 flex justify-between items-center">${prevLink}${nextLink}</footer>`;
    }

    function handleNavigation() {
        const battleId = window.location.hash.substring(1) || battles[0].id;
        const battleExists = battles.some(b => b.id === battleId);
        if (battleExists) {
            renderBattle(battleId);
        } else {
            renderBattle(battles[0].id);
        }
        window.scrollTo(0, 0);
    }

    battleIndexSelect.addEventListener('change', function() {
        window.location.hash = this.value;
    });

    // Handle initial page load and all navigation
    window.addEventListener('hashchange', handleNavigation);
    
    // Initial setup
    populateIndex();
    handleNavigation();

    </script>
</body>
</ht
</body>
</html>
